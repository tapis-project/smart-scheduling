# Smart Scheduling Data Injection 

# Description 
This smart scheduling project is designed to dynamically optimize job scheduling for jobs that are submmited to TACC based
high-performance computer (HPC) systems through the TACC TAPIS framework to optimize queue time jobs experince in the TAPIS framework. 


# Script Overview

To be able to run and fully utilize the ```test-search.py``` script, this README assumes a decent level of understanding regarding programming in Python and 
MySQL Workbench. 

The ```test-search.py``` functions by reading in submitted job data generated by each HPC system 
and utilizes the ```mysql.connector``` Python library to put the spliced data into a format that is inserted into a MySQL table 
that can be easily be queried at the user's discretion. 

Below is an example of the pre-spliced data: 
```commandline
JobID|User|Account|Start|End|Submit|Partition|Timelimit|JobName|State|NNodes|ReqCPUS|NodeList
4221134|tg840985|phy20012|2022-04-07T11:09:50|2022-04-08T07:50:34|2022-04-07T06:00:03|rtx|1-00:00:00|glidein|COMPLETED|1|16|c196-061
```

Each of the data points column names is used to create the column names of the table where the data will be store and therefore queried
to run statistical analysis to see how to best approach dynamically reallocate submmited jobs to the various HPC systems.

# Instructions on How to Run Script 

This instruction is based on the presumption that both [MySQL Workbench](https://dev.mysql.com/downloads/workbench/) and an IDE that has the [Python Library](https://www.python.org/downloads/) and [MySQL Connector package](https://dev.mysql.com/doc/connector-python/en/connector-python-installation-binary.html) has 
been fully installed onto your host machine. Links have been provided to do as such. 

After downloading this Github repository onto your host machine, you should have access to both the datasets and the code 
scripts to run this program. 


Open up the ```test-search.py``` file and look at lines 15-26:
```
# **************************************************************
# ASSIGN THESE RUNTIME PARAMETERS FOR YOUR ENVIRONMENT
#
# Before running this program assign the following parameters
# that are valid in your environment.

my_host = "localhost"  # host on which mysql runs
my_user = "root"  # db user that can create databases and tables
my_passwd = "password"  # db user password
my_database = "HPC_Job_Time_Data"  # the mysql datagbase into which all hpc records are written (hpc)
my_parent_dir = "/home/rcardone/work/smartsched/hpc/"  # the parent directory of the hpc-specific input directories
# **************************************************************
```

Here are the runtime parameters predetermined to have a valid runtime environment for our script. 
The variables to note are ```my_user```, ```my_passwd```, ```my_database```. To set up these variables 
with their correct values, we need to create these values in our workbench. 

## Creating the Database
Open up MySQL Workbench and click the plus sign by the "MySQL Connections". 

Set up the connection name, it may be whatever you would like it to be. Leave the hostname
variable set to "127.0.0.1", which is the IP address of your local machine. You may leave the username to 'root' and the password
as what you had previously set up, or change it to a user you had previously set up. 

Go ahead and test the connection. After a successful connection, close the window and click on the connection instantiation. 

Click on the cylinder with the line through it and create a new database or 'schema'. 
Give it whatever name you would like and save the instance. 

Take the username, password, and database values that you previously created, open up ```test-search.py``` and replace 
the preconditioned values previously mentioned above and replace them with your own values. You can also change the path where the job data is 
stored on your local machine and change the ```my_parent_dir``` to that directory path. 

# Running the Script 
Run the ```test-search.py``` script by testing the "Frontera" path. As such, when the script prompts for a HPC machine,
use the name "Frontera" as shown below:

```commandline
Enter a name of a HPC machine you would like to access: Frontera

Successfully Connected to SQL Database
```

In the dataset, there are 6 HPC systems to choose from: Frontera, Stampede2, Stampede, Lonestar6, Longhorn, and Maverick. 
You may test any of these systems. 

The script will either create the data table if it does not already exist and insert the data pertaining to each HPC
system as shown below: 

```commandline
Enter a name of a HPC machine you would like to access: Frontera

Successfully Connected to SQL Database: HPC_Job_Time_Data
New table generated
Indexes created

Start:  2022-09-12 21:21:13.384812
```

For any questions, feel free to message the admins of this Github repository: Costaki33 and richcar58.  